{"ast":null,"code":"var _jsxFileName = \"/home/sajish/Documents/Sajish/ULCA/ULCA/frontend/webapp/src/ui/container/DataSet/DatasetSeatch/SearchDownloadRecords.jsx\",\n    _s = $RefreshSig$();\n\nimport { Grid, Typography, Button, TextField, MenuItem, Checkbox, FormControlLabel, Divider } from '@material-ui/core';\nimport SearchResult from \"./SearchResult\";\nimport { withStyles } from '@material-ui/core/styles';\nimport DatasetStyle from '../../../styles/Dataset';\nimport Snackbar from '../../../components/common/Snackbar';\nimport BreadCrum from '../../../components/common/Breadcrum';\nimport UrlConfig from '../../../../configs/internalurlmapping';\nimport SearchAndDownload from '../../../../redux/actions/api/DataSet/DatasetSearch/SearchAndDownload';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport APITransport from \"../../../../redux/actions/apitransport/apitransport\";\nimport { useState, useEffect, useRef } from 'react';\nimport DownloadDatasetRecords from \"./DownloadDatasetRecords\";\nimport RequestNumberCreation from \"./RequestNumberCreation\";\nimport { useHistory, useParams } from 'react-router';\nimport Autocomplete from '../../../components/common/Autocomplete';\nimport { Language, FilterBy } from '../../../../configs/DatasetItems';\nimport SubmitSearchRequest from '../../../../redux/actions/api/DataSet/DatasetSearch/SubmitSearchRequest';\nimport DatasetType from '../../../../configs/DatasetItems';\nimport getLanguageLabel from '../../../../utils/getLabel';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst SearchAndDownloadRecords = props => {\n  _s();\n\n  const {\n    classes\n  } = props;\n  const url = UrlConfig.dataset;\n  const urlMySearch = UrlConfig.mySearches;\n  const param = useParams();\n  const history = useHistory();\n  const [languagePair, setLanguagePair] = useState({\n    source: '',\n    target: []\n  });\n  const [filterBy, setFilterBy] = useState({\n    domain: [],\n    source: [],\n    collectionMethod: []\n  });\n  const [datasetType, setDatasetType] = useState({\n    'parallel-corpus': true\n  });\n  const [count, setCount] = useState(0);\n  const [urls, setUrls] = useState({\n    downloadSample: '',\n    downloadAll: ''\n  });\n  const previousUrl = useRef();\n  const detailedReport = useSelector(state => state.mySearchReport); // const searchOptions = useSelector((state) => state.mySearchOptions);\n  // const dispatch = useDispatch();\n  // useEffect(() => {\n  //     const userObj = new SearchAndDownload();\n  //     searchOptions.result.length === 0 && dispatch(APITransport(userObj));\n  // }, []);\n\n  useEffect(() => {\n    previousUrl.current = params;\n    let data = detailedReport.responseData.filter(val => {\n      return val.sr_no === srno;\n    });\n\n    if (data[0]) {\n      setCount(data[0].count);\n      setUrls({\n        downloadSample: data[0].sampleUrl,\n        downloadAll: data[0].downloadUrl\n      });\n      let target = getLanguageLabel(data[0].targetLanguage);\n      console.log(target);\n      setLanguagePair({\n        target,\n        source: data[0].sourceLanguage\n      });\n    } else if (params === 'completed' && count === 0) history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/initiate/-1`);\n  }, []);\n  useEffect(() => {\n    if (previousUrl.current !== params && previousUrl.current !== 'initiate') {\n      setLanguagePair({\n        target: [],\n        source: \"\"\n      });\n      setFilterBy({\n        domain: [],\n        source: [],\n        collectionMethod: []\n      });\n    }\n\n    previousUrl.current = params;\n  });\n\n  const handleCheckboxChange = event => {\n    setState({ ...state,\n      [event.target.name]: event.target.checked\n    });\n  };\n\n  const handleLanguagePairChange = (value, property) => {\n    setLanguagePair({ ...languagePair,\n      [property]: value\n    });\n    if (property === 'source') setSrcError(false);else setTgtError(false);\n  };\n\n  const handleFilterByChange = (value, property) => {\n    setFilterBy({ ...filterBy,\n      [property]: value\n    });\n  };\n\n  const [snackbar, setSnackbarInfo] = useState({\n    open: false,\n    message: '',\n    variant: 'success'\n  });\n  const [state, setState] = useState({\n    checkedA: false,\n    checkedB: false\n  });\n  const [srcError, setSrcError] = useState(false);\n  const [tgtError, setTgtError] = useState(false);\n  const {\n    params,\n    srno\n  } = param;\n\n  const renderPage = () => {\n    switch (params) {\n      case 'inprogress':\n        return /*#__PURE__*/_jsxDEV(RequestNumberCreation, {\n          reqno: srno\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 24\n        }, this);\n\n      case 'completed':\n        return /*#__PURE__*/_jsxDEV(DownloadDatasetRecords, {\n          datasetType: \"Parallel\",\n          sentencePair: count,\n          urls: urls\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 24\n        }, this);\n\n      default:\n        return /*#__PURE__*/_jsxDEV(SearchResult, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 24\n        }, this);\n    }\n  };\n\n  const handleDatasetClick = property => {\n    history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/initiate/-1`);\n    clearfilter();\n    setDatasetType({\n      [property]: true\n    });\n    setSrcError(false);\n    setTgtError(false);\n  };\n\n  const getLabel = () => {\n    if (datasetType['parallel-corpus']) return \"Target Language *\";else if (datasetType['ocr-corpus']) return \"Select Script *\";else return \"Select Language *\";\n  };\n\n  const getTitle = () => {\n    if (datasetType['parallel-corpus']) return \"Select Language Pair\";else if (datasetType['ocr-corpus']) return \"Select Script\";else return \"Select Language\";\n  };\n\n  const clearfilter = () => {\n    setFilterBy({\n      domain: [],\n      source: [],\n      collectionMethod: []\n    });\n    setLanguagePair({\n      source: \"\",\n      target: []\n    });\n  };\n\n  const makeSubmitAPICall = (src, tgt, domain, collectionMethod, type) => {\n    setSnackbarInfo({ ...snackbar,\n      open: true,\n      message: 'Please wait while we process your request...',\n      variant: 'info'\n    });\n    const apiObj = new SubmitSearchRequest(type, tgt, src, domain, collectionMethod);\n    debugger;\n    fetch(apiObj.apiEndPoint(), {\n      method: 'post',\n      headers: apiObj.getHeaders().headers,\n      body: JSON.stringify(apiObj.getBody())\n    }).then(async res => {\n      if (res.ok) {\n        let response = await res.json();\n        history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/inprogress/${response.serviceRequestNumber}`);\n        handleSnackbarClose();\n      } else {\n        new Promise.reject(\"\");\n      }\n    }).catch(err => {\n      setSnackbarInfo({ ...snackbar,\n        open: true,\n        message: 'Failed to submit your search request...',\n        variant: 'error'\n      });\n    });\n  };\n\n  const handleSnackbarClose = () => {\n    setSnackbarInfo({ ...snackbar,\n      open: false\n    });\n  };\n\n  const handleSubmitBtn = () => {\n    let tgt = languagePair.target.map(trgt => trgt.value);\n    let domain = filterBy.domain.map(domain => domain.value);\n    let collectionMethod = filterBy.collectionMethod.map(method => method.value);\n\n    if (datasetType['parallel-corpus']) {\n      if (languagePair.source && languagePair.target.length) {\n        makeSubmitAPICall(languagePair.source, tgt, domain, collectionMethod);\n      } else if (!languagePair.source && !languagePair.target.length) {\n        setSrcError(true);\n        setTgtError(true);\n      } else if (!languagePair.source) setSrcError(true);else if (!languagePair.target.length) setTgtError(true);\n    } else {\n      if (!languagePair.target.length) setTgtError(true);else {\n        makeSubmitAPICall(null, tgt, domain, collectionMethod);\n      }\n    }\n  };\n\n  const renderDatasetButtons = () => {\n    return DatasetType.map((type, i) => {\n      return /*#__PURE__*/_jsxDEV(Button, {\n        className: classes.innerButton,\n        variant: datasetType[type.value] ? \"contained\" : \"outlined\",\n        color: \"primary\",\n        onClick: () => handleDatasetClick(type.value),\n        children: type.label\n      }, i, false, {\n        fileName: _jsxFileName,\n        lineNumber: 251,\n        columnNumber: 21\n      }, this);\n    });\n  };\n\n  const getTargetLang = () => {\n    return Language.filter(lang => lang.value !== languagePair.source);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: classes.searchDivStyle,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes.breadcrum,\n      children: /*#__PURE__*/_jsxDEV(BreadCrum, {\n        links: params === 'inprogress' || params === 'completed' ? [url, urlMySearch] : [url],\n        activeLink: \"Search & Download Records\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 268,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      spacing: 3,\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        className: (params === 'inprogress' || params === 'completed') && classes.blurOut,\n        item: true,\n        xs: 12,\n        sm: 5,\n        md: 4,\n        lg: 4,\n        xl: 4,\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          className: classes.subHeader,\n          variant: \"h6\",\n          children: \"Select Dataset Type\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 275,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.buttonDiv,\n          children: renderDatasetButtons()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 277,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          className: classes.subHeader,\n          variant: \"h6\",\n          children: getTitle()\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.subHeader,\n          children: [datasetType['parallel-corpus'] && /*#__PURE__*/_jsxDEV(TextField, {\n            className: classes.subHeader,\n            fullWidth: true,\n            error: srcError,\n            helperText: srcError && \"Source language is mandatory\",\n            select: true,\n            id: \"select-source-language\",\n            label: \"Source Language *\",\n            value: languagePair.source,\n            onChange: event => handleLanguagePairChange(event.target.value, 'source'),\n            children: Language.map(option => /*#__PURE__*/_jsxDEV(MenuItem, {\n              value: option.value,\n              children: option.label\n            }, option.value, false, {\n              fileName: _jsxFileName,\n              lineNumber: 319,\n              columnNumber: 37\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(Autocomplete, {\n            id: \"language-target\",\n            options: getTargetLang(),\n            filter: \"target\",\n            value: languagePair.target,\n            handleOnChange: handleLanguagePairChange,\n            label: getLabel(),\n            error: tgtError,\n            helperText: \"This field is mandatory\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 325,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 306,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          className: classes.subHeader,\n          variant: \"h6\",\n          children: \"Filter by\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 336,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.subHeader,\n          children: [/*#__PURE__*/_jsxDEV(Grid, {\n            container: true,\n            spacing: 1,\n            children: /*#__PURE__*/_jsxDEV(Grid, {\n              className: classes.subHeader,\n              item: true,\n              xs: 12,\n              sm: 12,\n              md: 12,\n              lg: 12,\n              xl: 12,\n              children: /*#__PURE__*/_jsxDEV(Autocomplete, {\n                id: \"domain\",\n                options: FilterBy.domain,\n                filter: \"domain\",\n                value: filterBy.domain,\n                handleOnChange: handleFilterByChange,\n                label: \"Select Domain\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 340,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 339,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 338,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Autocomplete, {\n            id: \"collection-method\",\n            options: FilterBy.collectionMethod,\n            filter: \"collectionMethod\",\n            value: filterBy.collectionMethod,\n            handleOnChange: handleFilterByChange,\n            label: \"Select Collection Method\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 337,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n          control: /*#__PURE__*/_jsxDEV(Checkbox, {\n            checked: state.checkedA,\n            onChange: handleCheckboxChange,\n            name: \"checkedA\",\n            color: \"primary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 372,\n            columnNumber: 29\n          }, this),\n          label: \"Vetted by multiple annotators\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(FormControlLabel, {\n          control: /*#__PURE__*/_jsxDEV(Checkbox, {\n            checked: state.checkedB,\n            onChange: handleCheckboxChange,\n            name: \"checkedB\",\n            color: \"primary\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 383,\n            columnNumber: 29\n          }, this),\n          label: \"Source sentences manually translated by multiple translators\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 381,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classes.clearNSubmit,\n          children: [/*#__PURE__*/_jsxDEV(Button, {\n            color: \"primary\",\n            onClick: clearfilter,\n            children: \"Clear\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 393,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            onClick: handleSubmitBtn,\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 396,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 392,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 273,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 1,\n        sm: 1,\n        md: 1,\n        lg: 1,\n        xl: 1,\n        children: /*#__PURE__*/_jsxDEV(Divider, {\n          className: classes.divider,\n          orientation: \"vertical\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 402,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        xs: 12,\n        sm: 6,\n        md: 7,\n        lg: 7,\n        xl: 7,\n        className: classes.parent,\n        children: renderPage()\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 272,\n      columnNumber: 13\n    }, this), snackbar.open && /*#__PURE__*/_jsxDEV(Snackbar, {\n      open: snackbar.open,\n      handleClose: handleSnackbarClose,\n      anchorOrigin: {\n        vertical: 'top',\n        horizontal: 'right'\n      },\n      message: snackbar.message,\n      variant: snackbar.variant\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 410,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 267,\n    columnNumber: 9\n  }, this);\n};\n\n_s(SearchAndDownloadRecords, \"xNFd3EwXv3+qVfvp0IGaa0snKW8=\", false, function () {\n  return [useParams, useHistory, useSelector];\n});\n\n_c = SearchAndDownloadRecords;\nexport default withStyles(DatasetStyle)(SearchAndDownloadRecords);\n\nvar _c;\n\n$RefreshReg$(_c, \"SearchAndDownloadRecords\");","map":{"version":3,"sources":["/home/sajish/Documents/Sajish/ULCA/ULCA/frontend/webapp/src/ui/container/DataSet/DatasetSeatch/SearchDownloadRecords.jsx"],"names":["Grid","Typography","Button","TextField","MenuItem","Checkbox","FormControlLabel","Divider","SearchResult","withStyles","DatasetStyle","Snackbar","BreadCrum","UrlConfig","SearchAndDownload","useDispatch","useSelector","APITransport","useState","useEffect","useRef","DownloadDatasetRecords","RequestNumberCreation","useHistory","useParams","Autocomplete","Language","FilterBy","SubmitSearchRequest","DatasetType","getLanguageLabel","SearchAndDownloadRecords","props","classes","url","dataset","urlMySearch","mySearches","param","history","languagePair","setLanguagePair","source","target","filterBy","setFilterBy","domain","collectionMethod","datasetType","setDatasetType","count","setCount","urls","setUrls","downloadSample","downloadAll","previousUrl","detailedReport","state","mySearchReport","current","params","data","responseData","filter","val","sr_no","srno","sampleUrl","downloadUrl","targetLanguage","console","log","sourceLanguage","push","process","env","PUBLIC_URL","handleCheckboxChange","event","setState","name","checked","handleLanguagePairChange","value","property","setSrcError","setTgtError","handleFilterByChange","snackbar","setSnackbarInfo","open","message","variant","checkedA","checkedB","srcError","tgtError","renderPage","handleDatasetClick","clearfilter","getLabel","getTitle","makeSubmitAPICall","src","tgt","type","apiObj","fetch","apiEndPoint","method","headers","getHeaders","body","JSON","stringify","getBody","then","res","ok","response","json","serviceRequestNumber","handleSnackbarClose","Promise","reject","catch","err","handleSubmitBtn","map","trgt","length","renderDatasetButtons","i","innerButton","label","getTargetLang","lang","searchDivStyle","breadcrum","blurOut","subHeader","buttonDiv","option","clearNSubmit","divider","parent","vertical","horizontal"],"mappings":"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","sourcesContent":["import {\n    Grid,\n    Typography,\n    Button,\n    TextField,\n    MenuItem,\n    Checkbox,\n    FormControlLabel,\n    Divider\n} from '@material-ui/core';\nimport SearchResult from \"./SearchResult\";\nimport { withStyles } from '@material-ui/core/styles';\nimport DatasetStyle from '../../../styles/Dataset';\nimport Snackbar from '../../../components/common/Snackbar';\nimport BreadCrum from '../../../components/common/Breadcrum';\nimport UrlConfig from '../../../../configs/internalurlmapping';\nimport SearchAndDownload from '../../../../redux/actions/api/DataSet/DatasetSearch/SearchAndDownload';\nimport { useDispatch, useSelector } from \"react-redux\";\nimport APITransport from \"../../../../redux/actions/apitransport/apitransport\";\nimport { useState, useEffect, useRef } from 'react';\nimport DownloadDatasetRecords from \"./DownloadDatasetRecords\";\nimport RequestNumberCreation from \"./RequestNumberCreation\";\nimport { useHistory, useParams } from 'react-router';\nimport Autocomplete from '../../../components/common/Autocomplete';\nimport { Language, FilterBy } from '../../../../configs/DatasetItems';\nimport SubmitSearchRequest from '../../../../redux/actions/api/DataSet/DatasetSearch/SubmitSearchRequest';\nimport DatasetType from '../../../../configs/DatasetItems';\nimport getLanguageLabel from '../../../../utils/getLabel';\n\nconst SearchAndDownloadRecords = (props) => {\n    const { classes } = props;\n    const url = UrlConfig.dataset;\n    const urlMySearch = UrlConfig.mySearches;\n    const param = useParams();\n    const history = useHistory();\n    const [languagePair, setLanguagePair] = useState({\n        source: '',\n        target: []\n    });\n    const [filterBy, setFilterBy] = useState({\n        domain: [],\n        source: [],\n        collectionMethod: []\n    });\n\n    const [datasetType, setDatasetType] = useState({\n        'parallel-corpus': true\n    })\n\n    const [count, setCount] = useState(0);\n    const [urls, setUrls] = useState({\n        downloadSample: '',\n        downloadAll: ''\n    })\n\n    const previousUrl = useRef();\n\n\n    const detailedReport = useSelector((state) => state.mySearchReport);\n\n    // const searchOptions = useSelector((state) => state.mySearchOptions);\n    // const dispatch = useDispatch();\n    // useEffect(() => {\n    //     const userObj = new SearchAndDownload();\n    //     searchOptions.result.length === 0 && dispatch(APITransport(userObj));\n    // }, []);\n\n    useEffect(() => {\n\n        previousUrl.current = params;\n\n        let data = detailedReport.responseData.filter((val) => {\n            return val.sr_no === srno\n        })\n\n        if (data[0]) {\n            setCount(data[0].count);\n            setUrls({\n                downloadSample: data[0].sampleUrl,\n                downloadAll: data[0].downloadUrl\n            })\n            let target = getLanguageLabel(data[0].targetLanguage)\n            console.log(target)\n            setLanguagePair({ target, source: data[0].sourceLanguage })\n        }\n        else if (params === 'completed' && count === 0)\n            history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/initiate/-1`)\n\n    }, []);\n\n    useEffect(() => {\n        if (previousUrl.current !== params && previousUrl.current !== 'initiate') {\n            setLanguagePair({ target: [], source: \"\" })\n            setFilterBy({\n                domain: [],\n                source: [],\n                collectionMethod: []\n            })\n        }\n        previousUrl.current = params;\n    })\n\n\n\n    const handleCheckboxChange = (event) => {\n        setState({ ...state, [event.target.name]: event.target.checked });\n    };\n    const handleLanguagePairChange = (value, property) => {\n        setLanguagePair({ ...languagePair, [property]: value });\n\n        if (property === 'source')\n            setSrcError(false)\n        else\n            setTgtError(false)\n    };\n    const handleFilterByChange = (value, property) => {\n        setFilterBy({ ...filterBy, [property]: value });\n    };\n    const [snackbar, setSnackbarInfo] = useState({\n        open: false,\n        message: '',\n        variant: 'success'\n    })\n    const [state, setState] = useState({\n        checkedA: false,\n        checkedB: false,\n    });\n    const [srcError, setSrcError] = useState(false)\n    const [tgtError, setTgtError] = useState(false)\n    const { params, srno } = param\n    const renderPage = () => {\n        switch (params) {\n            case 'inprogress':\n                return <RequestNumberCreation reqno={srno} />\n            case 'completed':\n                return <DownloadDatasetRecords datasetType={\"Parallel\"} sentencePair={count} urls={urls} />\n            default:\n                return <SearchResult />\n        }\n    }\n\n    const handleDatasetClick = (property) => {\n        history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/initiate/-1`)\n        clearfilter()\n        setDatasetType({ [property]: true })\n        setSrcError(false)\n        setTgtError(false)\n    }\n    const getLabel = () => {\n        if (datasetType['parallel-corpus'])\n            return \"Target Language *\"\n        else if (datasetType['ocr-corpus'])\n            return \"Select Script *\"\n        else\n            return \"Select Language *\"\n    }\n\n    const getTitle = () => {\n        if (datasetType['parallel-corpus'])\n            return \"Select Language Pair\"\n        else if (datasetType['ocr-corpus'])\n            return \"Select Script\"\n        else\n            return \"Select Language\"\n    }\n    const clearfilter = () => {\n        setFilterBy({\n            domain: [],\n            source: [],\n            collectionMethod: []\n        });\n        setLanguagePair({\n            source: \"\",\n            target: []\n        });\n    }\n\n    const makeSubmitAPICall = (src, tgt, domain, collectionMethod, type) => {\n        \n        setSnackbarInfo({\n            ...snackbar,\n            open: true,\n            message: 'Please wait while we process your request...',\n            variant: 'info'\n        })\n        const apiObj = new SubmitSearchRequest(type, tgt, src, domain, collectionMethod)\n        debugger\n        fetch(apiObj.apiEndPoint(), {\n            method: 'post',\n            headers: apiObj.getHeaders().headers,\n            body: JSON.stringify(apiObj.getBody())\n        })\n            .then(async res => {\n                if (res.ok) {\n                    let response = await res.json()\n                    history.push(`${process.env.PUBLIC_URL}/search-and-download-rec/inprogress/${response.serviceRequestNumber}`)\n                    handleSnackbarClose()\n\n                } else {\n                    new Promise.reject(\"\")\n                }\n            })\n            .catch(err => {\n                setSnackbarInfo({\n                    ...snackbar,\n                    open: true,\n                    message: 'Failed to submit your search request...',\n                    variant: 'error'\n                })\n            })\n\n    }\n    const handleSnackbarClose = () => {\n        setSnackbarInfo({ ...snackbar, open: false })\n    }\n    const handleSubmitBtn = () => {\n        let tgt = languagePair.target.map(trgt => trgt.value)\n        let domain = filterBy.domain.map(domain => domain.value)\n        let collectionMethod = filterBy.collectionMethod.map(method => method.value)\n        if (datasetType['parallel-corpus']) {\n            if (languagePair.source && languagePair.target.length) {\n                makeSubmitAPICall(languagePair.source, tgt, domain, collectionMethod)\n            }\n\n            else if (!languagePair.source && !languagePair.target.length) {\n                setSrcError(true)\n                setTgtError(true)\n            }\n\n            else if (!languagePair.source)\n                setSrcError(true)\n            else if (!languagePair.target.length)\n                setTgtError(true)\n        }\n        else {\n            if (!languagePair.target.length)\n                setTgtError(true)\n            else {\n                makeSubmitAPICall(null, tgt, domain, collectionMethod)\n            }\n\n        }\n\n\n    }\n\n    const renderDatasetButtons = () => {\n        return (\n            DatasetType.map((type, i) => {\n                return (\n                    <Button className={classes.innerButton} variant={datasetType[type.value] ? \"contained\" : \"outlined\"}\n                        color=\"primary\"\n                        key={i}\n                        onClick={() => handleDatasetClick(type.value)}\n                    >\n                        {type.label}\n                    </Button>)\n            })\n\n        )\n    }\n    const getTargetLang = () => {\n        return Language.filter(lang => lang.value !== languagePair.source)\n    }\n\n    return (\n        <div className={classes.searchDivStyle}>\n            <div className={classes.breadcrum}>\n\n                <BreadCrum links={(params === 'inprogress' || params === 'completed') ? [url, urlMySearch] : [url]} activeLink=\"Search & Download Records\" />\n            </div>\n            <Grid container spacing={3}>\n                <Grid className={(params === 'inprogress' || params === 'completed') && classes.blurOut} item xs={12} sm={5} md={4} lg={4} xl={4}>\n\n                    <Typography className={classes.subHeader} variant=\"h6\">Select Dataset Type</Typography>\n\n                    <div className={classes.buttonDiv} >\n                        {renderDatasetButtons()}\n                        {/* <Button className={classes.innerButton} variant={datasetType.pd ? \"contained\" : \"outlined\"}\n                            color=\"primary\"\n                            onClick={() => handleDatasetClick('pd')}\n                        >\n                            Parallel Dataset\n                    </Button>\n                        <Button className={classes.innerButton} variant={datasetType.md ? \"contained\" : \"outlined\"}\n                            color=\"primary\"\n                            onClick={() => handleDatasetClick('md')}\n                        >\n                            Monolingual Dataset\n                    </Button>\n                        <Button className={classes.innerButton} variant={datasetType.atd ? \"contained\" : \"outlined\"}\n                            color=\"primary\"\n                            onClick={() => handleDatasetClick('atd')}\n                        >\n                            ASR/TTS Dataset\n                    </Button>\n                        <Button className={classes.innerButton} variant={datasetType.od ? \"contained\" : \"outlined\"}\n                            color=\"primary\"\n                            onClick={() => handleDatasetClick('od')}\n                        >\n                            OCR Dataset\n                    </Button> */}\n                    </div>\n\n                    <Typography className={classes.subHeader} variant=\"h6\">{getTitle()}</Typography>\n                    <div className={classes.subHeader}>\n                        {datasetType['parallel-corpus'] &&\n                            <TextField className={classes.subHeader}\n                                fullWidth\n                                error={srcError}\n                                helperText={srcError && \"Source language is mandatory\"}\n                                select\n                                id=\"select-source-language\"\n                                label=\"Source Language *\"\n                                value={languagePair.source}\n                                onChange={(event) => handleLanguagePairChange(event.target.value, 'source')}\n                            >\n                                {Language.map((option) => (\n                                    <MenuItem key={option.value} value={option.value}>\n                                        {option.label}\n                                    </MenuItem>\n                                ))}\n                            </TextField>}\n\n                        <Autocomplete\n                            id=\"language-target\"\n                            options={getTargetLang()}\n                            filter='target'\n                            value={languagePair.target}\n                            handleOnChange={handleLanguagePairChange}\n                            label={getLabel()}\n                            error={tgtError}\n                            helperText=\"This field is mandatory\"\n                        />\n                    </div>\n                    <Typography className={classes.subHeader} variant=\"h6\">Filter by</Typography>\n                    <div className={classes.subHeader}>\n                        <Grid container spacing={1}>\n                            <Grid className={classes.subHeader} item xs={12} sm={12} md={12} lg={12} xl={12}>\n                                <Autocomplete\n                                    id=\"domain\"\n                                    options={FilterBy.domain}\n                                    filter=\"domain\"\n                                    value={filterBy.domain}\n                                    handleOnChange={handleFilterByChange}\n                                    label=\"Select Domain\"\n                                />\n                            </Grid>\n                            {/* <Grid item xs={12} sm={12} md={6} lg={6} xl={6}>\n                                <Autocomplete\n                                    id=\"source\"\n                                    options={sourceLanguages}\n                                    filter=\"source\"\n                                    value={filterBy.source}\n                                    handleOnChange={handleFilterByChange}\n                                    label=\"Select Source\"\n                                />\n                            </Grid> */}\n                        </Grid>\n                        <Autocomplete\n                            id=\"collection-method\"\n                            options={FilterBy.collectionMethod}\n                            filter=\"collectionMethod\"\n                            value={filterBy.collectionMethod}\n                            handleOnChange={handleFilterByChange}\n                            label=\"Select Collection Method\"\n                        />\n                    </div>\n\n                    <FormControlLabel\n                        control={\n                            <Checkbox\n                                checked={state.checkedA}\n                                onChange={handleCheckboxChange}\n                                name=\"checkedA\"\n                                color=\"primary\"\n                            />\n                        }\n                        label=\"Vetted by multiple annotators\"\n                    />\n                    <FormControlLabel\n                        control={\n                            <Checkbox\n                                checked={state.checkedB}\n                                onChange={handleCheckboxChange}\n                                name=\"checkedB\"\n                                color=\"primary\"\n                            />\n                        }\n                        label=\"Source sentences manually translated by multiple translators\"\n                    />\n                    <div className={classes.clearNSubmit}>\n                        <Button color=\"primary\" onClick={clearfilter}>\n                            Clear\n                    </Button>\n                        <Button variant=\"contained\" color=\"primary\" onClick={handleSubmitBtn}>\n                            Submit\n                    </Button>\n                    </div>\n                </Grid>\n                <Grid item xs={1} sm={1} md={1} lg={1} xl={1}>\n                    <Divider className={classes.divider} orientation=\"vertical\" />\n                </Grid>\n                <Grid item xs={12} sm={6} md={7} lg={7} xl={7} className={classes.parent}>\n                    {renderPage()}\n                </Grid>\n\n            </Grid>\n            {snackbar.open &&\n                <Snackbar\n                    open={snackbar.open}\n                    handleClose={handleSnackbarClose}\n                    anchorOrigin={{ vertical: 'top', horizontal: 'right' }}\n                    message={snackbar.message}\n                    variant={snackbar.variant}\n                />}\n        </div>\n    )\n\n\n}\n\nexport default withStyles(DatasetStyle)(SearchAndDownloadRecords);"]},"metadata":{},"sourceType":"module"}